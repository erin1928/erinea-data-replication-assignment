---
title: "Data Replication"
author: "Erin Anderson"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

My study is testing the theory that bees prefer to frequent the same flowers, as opposed to visiting multiple different flowers in a patch. Sampling was done in Sweden with reared colonies of bees in an open fied. Bees were individually marked and ID'd and left to pollinate for 5 days at a time. After each period pollen was removed from the bees bodies and collected in jars. Mahcine learning was used to identify pollen samples from specific flowers which were identified in the field. After the program was run, individual pollen samples from ID'd bees were added to a csv file, noting each bee and where their pollen came from, and how much (in g) pollen they had extracted from the flower per trip. 

I will be looking for you to clearly take your reader through all of the elements of data manipulation, analysis, and, where appropriate, visualization. You should provide as much coding detail, explanation, and output tables as necessary to compare your results to those published.

Annotate your code well, and good luck!


!["Bee flower constancy"](/Users/erin/desktop/bee_flower_consistency.pdf)


## chi squared test, p value, stray from normal
```{r csv, include=FALSE}
bee_data <- read.csv("bee_data.csv", sep = ',', header = TRUE, stringsAsFactors = TRUE)
bee_data
head(bee_data)
```
First we must identify and name all of the relevant columns within the csv. Here I am calling the columns of flower species that pollen was taken from, and giving them an easier and more memorable name to work with throughout the replication assignment.
```{r calling rows, include=FALSE}
Prunus <- (bee_data$P_Prunus.group)
Prunus
Brassicaceae <- (bee_data$P_Brassicaceae)
Brassicaceae
Lamium <- (bee_data$P_Lamium)
Lamium
Acer <- (bee_data$P_Acer)
Acer
Lonicera <- (bee_data$P_Lonicera)
Lonicera
Salix <- (bee_data$P_Salix)
Salix
Prunus_Group_B <- sample(bee_data$P_Prunus.groupB)
Prunus_Group_B
Papaver <- (bee_data$P_Papaver)
Papaver
Cytisus <- (bee_data$P_Cytisus)
Cytisus
Trifolium_repens <- (bee_data$P_Trifolium.repens.group)
Trifolium_repens
Aesculus <- (bee_data$P_Aesculus)
Aesculus
Pulmonaria_Group <- (bee_data$P_Pulmonaria.group)
Pulmonaria_Group
Laburnum <- (bee_data$P_Laburnum)
Laburnum
Phacelia <- (bee_data$P_Phacelia)
Phacelia
```

Now, in order to replicate our first figure, the mean weight (in grams) of each pollen type needs to be calculated. By using the mean() function I am directly calculating the averages of each column that I assigned in the previous step.
```{r calculating means, include=TRUE}
mean(Prunus)
mean(Brassicaceae)
mean(Lamium)
mean(Acer)
mean(Lonicera)
mean(Salix)
mean(Prunus_Group_B)
mean(Papaver)
mean(Cytisus)
mean(Trifolium_repens)
mean(Aesculus)
mean(Pulmonaria_Group)
mean(Laburnum)
mean(Phacelia)
```

```{r calculating proportions, include=FALSE}
total_species_count <- (mean(Phacelia) + mean(Laburnum) + mean(Pulmonaria_Group) + mean(Aesculus) + mean(Cytisus) + mean(Papaver) + mean(Prunus_Group_B) + mean(Salix) + mean(Lonicera) + mean(Acer) + mean(Lamium) + mean(Brassicaceae) + mean(Prunus))
total_species_count
percentage_Phacelia<- (mean(Phacelia) / total_species_count)
percentage_Phacelia
percentage_Laburnum <- (mean(Laburnum) / total_species_count)
percentage_Laburnum
percentage_Pulmonaria_Group <- (mean(Pulmonaria_Group) / total_species_count)
percentage_Pulmonaria_Group
percentage_Aesculus <- (mean(Aesculus) / total_species_count)
percentage_Aesculus
percentage_Trifolium_repens <- (mean(Trifolium_repens) / total_species_count)
percentage_Trifolium_repens
percentage_Cytisus <- (mean(Cytisus) / total_species_count)
percentage_Cytisus
percentage_Papaver <- (mean(Papaver) / total_species_count)
percentage_Papaver
percentage_Prunus_Group_B <- (mean(Prunus_Group_B) / total_species_count)
percentage_Prunus_Group_B
percentage_Salix <- (mean(Salix) / total_species_count)
percentage_Salix
percentage_Lonicera <- (mean(Lonicera) / total_species_count)
percentage_Lonicera
percentage_Acer <- (mean(Acer) / total_species_count)
percentage_Acer
percentage_Lamium <- (mean(Lamium) / total_species_count)
percentage_Lamium
percentage_Brassicaceae <- (mean(Brassicaceae) / total_species_count)
percentage_Brassicaceae
percentage_Prunus <- (mean(Prunus) / total_species_count)
percentage_Prunus
```

```{r bar chart, include=TRUE}
#setting a common numerical value to pull from in the y axis
means <- c(mean(Prunus), mean(Brassicaceae), mean(Lamium), mean(Acer), mean(Lonicera), mean(Salix), mean(Prunus_Group_B), mean(Papaver), mean(Cytisus), mean(Trifolium_repens), mean(Aesculus), mean(Pulmonaria_Group), mean(Laburnum), mean(Phacelia))
#Now using a character vector to pull names of each group on the x-axis
Flower_species <- c("Prunus", "Brassicaceae", "Lamium", "Acer", "Lonicera", "Salix", "Prunus_Group_B", "Papaver", "Cytisus", "Trifolium_repens", "Aesculus", "Pulmonaria_Group", "Laburnum", "Phacelia")
library(RColorBrewer)
coul <- brewer.pal(14, "Set3")
#This sets rainbow colors for my graph
par(mar=c(8,4,4,1)+.1)
#This changes the margins on my graph, the first one deals with the bottom allowing me to fit all the words onto the chart
barplot(means, ylim = c(0.00, 0.20), names.arg = Flower_species, las = 2, space = 0.05, xlab = " ", ylab = "Pollen Proportion", main = "Pollen Proportion vs. Flower Species", col=coul, cex.axis=0.9)
# las = 2 moves the x-axis labels vertical
```

![Original Chart](/Users/erin/desktop/Original Chart.png)